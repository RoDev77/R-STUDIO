<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Reset Password ‚Äî R Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" href="./images/RSLogo.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; font-family: Inter }
body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #6366f1, #7c3aed);
}
.card {
  background: white;
  max-width: 420px;
  width: 100%;
  padding: 36px;
  border-radius: 24px;
  box-shadow: 0 30px 70px rgba(0,0,0,.25);
}
.brand {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
}
.brand img { width: 44px }
.brand h1 { font-weight: 800 }
p { text-align: center; color: #6b7280 }
label { font-weight: 700; font-size: 13px }
input {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: 1px solid #e5e7eb;
}
button {
  margin-top: 18px;
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: none;
  font-weight: 800;
  background: linear-gradient(135deg,#6366f1,#7c3aed);
  color: white;
  cursor: pointer;
}
button:disabled { opacity: .6 }
.message { text-align:center; margin-top:14px; display:none }
.success { color:#16a34a }
.footer { text-align:center; margin-top:20px }
</style>
</head>

<body>

<div class="card">
  <div class="brand">
    <img src="./images/RSLogo.png">
    <h1>R STUDIO</h1>
  </div>

  <p>Masukkan email akun kamu untuk reset password.</p>

  <form id="resetForm">
    <label>Email</label>
    <input type="email" id="email" required>

    <button id="resetBtn">üì© Kirim Link Reset</button>
    <div id="msgSuccess" class="message success"></div>
  </form>

  <div class="footer">
    <a href="login.html">‚Üê Kembali ke Login</a>
  </div>
</div>

<script>
const form = document.getElementById("resetForm");
const emailInput = document.getElementById("email");
const btn = document.getElementById("resetBtn");
const msgSuccess = document.getElementById("msgSuccess");

const COOLDOWN = 60;
const KEY = "reset_cooldown";

function remaining() {
  const t = localStorage.getItem(KEY);
  if (!t) return 0;
  return Math.max(0, COOLDOWN - Math.floor((Date.now() - t) / 1000));
}

function updateBtn() {
  const r = remaining();
  if (r > 0) {
    btn.disabled = true;
    btn.textContent = `Tunggu ${r}s`;
  } else {
    btn.disabled = false;
    btn.textContent = "üì© Kirim Link Reset";
  }
}

setInterval(updateBtn, 1000);
updateBtn();

form.addEventListener("submit", async e => {
  e.preventDefault();
  if (remaining() > 0) return;

  btn.disabled = true;
  btn.textContent = "Mengirim...";

  await fetch("/api/reset-password", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email: emailInput.value })
  });

  localStorage.setItem(KEY, Date.now());
  msgSuccess.textContent =
    "Jika email terdaftar, link reset akan dikirim. Cek inbox atau spam.";
  msgSuccess.style.display = "block";
  updateBtn();
});
</script>

</body>
</html>
